<template>
    <lightning-card title="Social Media Insights" icon-name="standard:social">
        <div class="slds-p-around_medium">
            <div style="max-height: 500px; overflow-y: auto;">
                <template for:each={filteredData} for:item="item">
                    <div key={item.id} class="slds-box slds-m-bottom_medium">
                        <!-- Header -->
                        <div class="slds-grid slds-wrap slds-m-bottom_x-small">
                            <div class="slds-col slds-size_1-of-2">
                                <strong>{item.author}</strong>
                                <lightning-badge label={item.source} class="slds-m-left_small"></lightning-badge>
                                <!-- <span class="slds-text-color_success slds-m-left_x-small">{item.sentiment}</span> -->
                            </div>
                            <div class="slds-col slds-size_1-of-2 slds-text-align_right">
                                <lightning-formatted-date-time value={item.date}></lightning-formatted-date-time>
                            </div>
                        </div>
                            
                        <!-- Message -->
                        <p class="slds-m-bottom_small">{item.message}</p>

                        <!-- Buttons -->
                        <div class="slds-grid slds-wrap slds-m-bottom_small">
                            <lightning-button variant="base" label="Reply" class="slds-m-right_small" onclick={onreply}></lightning-button>
                            <lightning-button variant="base" label="View Original" class="slds-m-right_small" onclick={onview}></lightning-button>
                            <lightning-button variant="success" label="Convert to Lead" class="slds-m-right_small" onclick={onclickedshowconverttoLead} data-id={item.id}></lightning-button>
                            <lightning-button variant="destructive" label="Create Case" onclick={onclickedshowconverttoCase} data-id={item.id}></lightning-button>
                        </div>

                        <!-- convert to leads -->
                        <template if:true={showconverttoLead}>
                            <c-convert-lead 
                                item-id={selectedLeadItemId} 
                                item={item} 
                                onmodalclosed={ConvertToLead}>
                            </c-convert-lead>
                        </template>


                        <!-- convert to case -->
        
                        <template if:true={showconverttocase}>
                            <c-convert-case 
                                item-id={selectedLeadItemId} 
                                item={item} 
                                onmodalclosed={ConvertTocase}>
                            </c-convert-case>
                        </template>


                        <!-- ON View Orginal -->
                         <template if:true={showViewOriginal}>
                         <c-view-original 
                            item-id={selectedLeadItemId} 
                            item={item} 
                            onmodalclosed={ViewOriginal}>
                        </c-view-original>
                        </template>

                        <!-- REPLAY ACtion -->
                         

                        <!-- AI Analysis -->
                       <template if:true={showAnalyis}>
                        <div class="slds-box slds-theme_shade">
                            <p><strong>AI Analysis</strong></p>
                            <p>Content Type: {item.analysis.contentType}</p>
                            <p>Intent: {item.analysis.intent}</p>
                            <p>Urgency: {item.analysis.urgency}</p>
                            <p>Engagement: {item.analysis.engagement}</p>
                            <p>Confidence: {item.analysis.confidence}%</p>
                            <p class="slds-text-color_weak slds-text-body_small">Suggested Action: {item.analysis.action}</p>
                        </div>
                         </template>
                    </div>
                </template>
            </div>
        </div>
    </lightning-card>
</template>